# PaywallDemo

Простое демо‑приложение на SwiftUI с онбордингом, paywall и сохранением состояния подписки через `UserDefaults` (`@AppStorage`).

## Стек

- Swift 5+
- SwiftUI
- UserDefaults (@AppStorage)
- NavigationStack / TabView / List

## Архитектура

Приложение максимально упрощено под формат тестового задания:

- `PaywallDemoApp`  
  Точка входа. Запускает `ContentView` в `WindowGroup`.

- `ContentView`  
  Корневой экран‑роутер.  
  На основе двух флагов в `@AppStorage` решает, что показать:
  - `isSubscribed` — куплена ли подписка.
  - `hasFinishedOnboarding` — завершён ли онбординг.

  Логика:
  - `isSubscribed == true` → сразу `MainView`.
  - `isSubscribed == false && hasFinishedOnboarding == true` → `PaywallView`.
  - Иначе → `OnboardingFlowView`.

- `OnboardingFlowView` / `OnboardingPageView`  
  2‑экранный онбординг (текст + простая иллюстрация).  
  Кнопка «Продолжить» листает страницы, на последней странице завершает онбординг (`hasFinishedOnboarding = true`).

- `PaywallView`  
  Экран с двумя тарифами: Месяц / Год (год с пометкой «Выгоднее»).  
  Кнопка «Продолжить»:
  - Эмулирует покупку с задержкой ~0.8 сек.
  - Показывает `ProgressView` и текст «Покупка…».
  - После «успеха» ставит `isSubscribed = true` → приложение переключается на `MainView`.
  - Повторные нажатия во время загрузки блокируются.

- `MainView`  
  Главный экран с `NavigationStack` и `List`:
  - Секция с примерным списком задач.
  - Секция «О приложении» с описанием логики.

  В тулбаре есть кнопка «Сбросить подписку» — сбрасывает `isSubscribed` и `hasFinishedOnboarding`, чтобы можно было снова пройти весь сценарий.

## Сохранение состояния

Для хранения состояния подписки и факта прохождения онбординга используется:

- `@AppStorage("isSubscribed")` → булев флаг в `UserDefaults`, переживает перезапуск приложения.
- `@AppStorage("hasFinishedOnboarding")` → флаг завершения онбординга.

Благодаря этому:

- После «покупки» при следующем запуске пользователь сразу попадает на главный экран.
- Онбординг и paywall больше не показываются, пока не будет выполнен «Сброс подписки».

## Как это использовать в скринкасте

Во время записи экрана можно показать:

1. **Генерацию кода с помощью нейросети**
   - Например, генерацию базовой структуры экранов онбординга и paywall, или примеров текста/копирайта.
2. **Оптимизацию / рефакторинг**
   - Вынесение логики покупки в отдельный метод (`performFakePurchase()`), добавление защиты от двойных нажатий, улучшение читаемости.
3. **Поиск ошибок**
   - Проверка корректности логики переходов между экранами и состояния `@AppStorage`.
4. **Ускорение разработки**
   - Автогенерация README, комментариев, вариантов дизайна paywall.

## Что бы улучшил при большем времени

- Вынес бы состояние и бизнес‑логику в отдельный слой (например, `ViewModel` или простой `ObservableObject`), чтобы `View` были максимально «тонкими`.
- Разнёс бы экраны по отдельным файлам (`OnboardingFlowView.swift`, `PaywallView.swift`, `MainView.swift` и т.д.) для лучшей читаемости.
- Добавил бы:
  - UI‑тесты на сценарии: первый запуск / после подписки / сброс подписки.
  - Более реалистичный paywall: условия, ссылки на политику и оферту, пробный период.
  - Локализацию (RU/EN), поддержку тёмной темы и улучшенную доступность (Dynamic Type, VoiceOver).
- При интеграции реального биллинга — вынес бы работу с StoreKit в отдельный сервис/модуль.


# PayWell-Demo
